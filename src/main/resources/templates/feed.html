<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <title>Socialize  | Feed </title>
      <link rel="shortcut icon" th:href="@{/assets/images/favicon.ico}" />
      <link rel="stylesheet" th:href="@{/assets/css/libs.min.css}">
      <link rel="stylesheet" th:href="@{/assets/css/socialv.css}">
      <link rel="stylesheet" th:href="@{/assets/vendor/fortawesome/fontawesome-free/css/all.min.css}">
      <link rel="stylesheet" th:href="@{/assets/vendor/remixicon/fonts/remixicon.css}">
      <link rel="stylesheet" th:href="@{/assets/vendor/vanillajs-datepicker/dist/css/datepicker.css}">
      <link rel="stylesheet" th:href="@{/assets/vendor/line-awesome/dist/font-awesome-line-awesome/css/all.min.css}">
      <link rel="stylesheet" th:href="@{/assets/vendor/line-awesome/dist/line-awesome/css/line-awesome.min.css}">
      
  </head>
  <body class="  ">
    <!-- loader Start -->
    <div id="loading">
          <div id="loading-center">
          </div>
    </div>
    <!-- loader END -->
    <!-- Wrapper Start -->
    <div class="wrapper">
       <th:block th:include="fragments/navigation :: navigation"></th:block>
        <div id="content-page" class="content-page">
      <div class="container">
         <div class="row">
            <div class="col-lg-8 row m-0 p-0">
               <div class="col-sm-12">
                  <div id="post-modal-data" class="card card-block card-stretch card-height">
                     <div class="card-header d-flex justify-content-between">
                        <div class="header-title">
                           <h4 class="card-title">Create Post</h4>
                        </div>
                     </div>
                     <div class="card-body">
                        <div class="d-flex align-items-center">
                           <div class="user-img">
                              <img src="../assets/images/user/1.jpg" alt="userimg" class="avatar-60 rounded-circle">
                           </div>
                           <form class="post-text ms-3 w-100" id="create-post-form">
                              <textarea class="form-control rounded" id="postContent" rows="3" placeholder="Write something here..." style="border:none;"></textarea>
                              <hr>
                              <ul class="post-opt-block d-flex list-inline m-0 p-0 flex-wrap">
                                 <li class="me-3 mb-md-0 mb-2">
                                    <label for="imageUpload" class="btn btn-soft-primary">
                                       <img src="../assets/images/small/07.png" alt="icon" class="img-fluid me-2"> Photo/Video
                                       <input type="file" id="imageUpload" accept="image/*" style="display:none;">
                                    </label>
                                 </li>

                              </ul>
                              <div class="form-group mt-3" id="imagePreviewContainer" style="display:none;">
                                 <img id="imagePreview" class="preview-image img-fluid">
                              </div>
                              <button type="submit" class="btn btn-primary mt-3" id="submitPostBtn">Submit</button>
                           </form>
                        </div>
                     </div>
                  </div>
               </div>

               <!-- new post should enter here -->
               <!--gpt here is a post start -->
               <!-- this is how a post looks like-->
               <div class="new-posts"></div>
               <div class="col-sm-12">
                  <div class="card card-block card-stretch card-height">
                     <div class="card-body">
                        <div class="user-post-data">
                           <div class="d-flex flex-wrap">
                              <div class="media-support-user-img mr-3">
                                 <img class="rounded-circle img-fluid" src="../assets/images/user/01.jpg" alt="">
                              </div>
                              <div class="media-support-info mt-2">
                                 <h5 class="mb-0 d-inline-block"><a href="#" class="">Anna Sthesia</a></h5>
                                 <p class="mb-0 d-inline-block">  New Post</p>
                                 <p class="mb-0 text-primary">Just Now</p>
                              </div>
                           </div>
                        </div>
                        <div class="mt-3">
                           <!-- post's text content goes in the p tag below -->
                           <p>Went on hiking with My fellow students it was a blast</p>
                        </div>
                        <div class="user-post">
                           <div class="d-flex">
                              <div class="col-md-12">
                                 <!-- image goes here in the image tag below -->
                                 <a href="#"><img src="../assets/images/page-img/p1.jpg" alt="post-image" class="img-fluid rounded w-100"></a>
                              </div>
                           </div>
                        </div>
                        <!-- comments goes here. since we have no comments just duplicate this ne-->
                        <div class="comment-area mt-3">
                           <div class="d-flex justify-content-between align-items-center">
                              <div class="like-block position-relative d-flex align-items-center">
                                 <div class="d-flex align-items-center">
                                    <div class="like-data">
                                       <div class="dropdown">
                                          <span class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="button">
                                          <img src="../assets/images/icon/01.png" class="img-fluid" alt="">
                                          </span>
                                          <div class="dropdown-menu">
                                             <a class="ml-2 mr-2" href="#" data-toggle="tooltip" data-placement="top" title="" data-original-title="Like"><img src="../assets/images/icon/01.png" class="img-fluid" alt=""></a>
                                             <a class="mr-2" href="#" data-toggle="tooltip" data-placement="top" title="" data-original-title="Love"><img src="../assets/images/icon/02.png" class="img-fluid" alt=""></a>
                                             <a class="mr-2" href="#" data-toggle="tooltip" data-placement="top" title="" data-original-title="Happy"><img src="../assets/images/icon/03.png" class="img-fluid" alt=""></a>
                                             <a class="mr-2" href="#" data-toggle="tooltip" data-placement="top" title="" data-original-title="HaHa"><img src="../assets/images/icon/04.png" class="img-fluid" alt=""></a>
                                             <a class="mr-2" href="#" data-toggle="tooltip" data-placement="top" title="" data-original-title="Think"><img src="../assets/images/icon/05.png" class="img-fluid" alt=""></a>
                                             <a class="mr-2" href="#" data-toggle="tooltip" data-placement="top" title="" data-original-title="Sade"><img src="../assets/images/icon/06.png" class="img-fluid" alt=""></a>
                                             <a class="mr-2" href="#" data-toggle="tooltip" data-placement="top" title="" data-original-title="Lovely"><img src="../assets/images/icon/07.png" class="img-fluid" alt=""></a>
                                          </div>
                                       </div>
                                    </div>
                                    <div class="total-like-block ml-2 mr-3">
                                       <div class="dropdown">
                                          <span class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="button">
                                          140 Likes
                                          </span>
                                          <div class="dropdown-menu">
                                             <a class="dropdown-item" href="#">Max Emum</a>
                                             <a class="dropdown-item" href="#">Bill Yerds</a>
                                             <a class="dropdown-item" href="#">Hap E. Birthday</a>
                                             <a class="dropdown-item" href="#">Tara Misu</a>
                                             <a class="dropdown-item" href="#">Midge Itz</a>
                                             <a class="dropdown-item" href="#">Sal Vidge</a>
                                             <a class="dropdown-item" href="#">Other</a>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                                 <div class="total-comment-block">
                                    <div class="dropdown">
                                       <span class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="button">
                                       20 Comment
                                       </span>
                                       <div class="dropdown-menu">
                                          <a class="dropdown-item" href="#">Max Emum</a>
                                          <a class="dropdown-item" href="#">Bill Yerds</a>
                                          <a class="dropdown-item" href="#">Hap E. Birthday</a>
                                          <a class="dropdown-item" href="#">Tara Misu</a>
                                          <a class="dropdown-item" href="#">Midge Itz</a>
                                          <a class="dropdown-item" href="#">Sal Vidge</a>
                                          <a class="dropdown-item" href="#">Other</a>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                              <div class="share-block d-flex align-items-center feather-icon mr-3">
                                 <a href="#"><i class="ri-share-line"></i>
                                 <span class="ml-1">99 Share</span></a>
                              </div>
                           </div>
                           <hr>
                           <ul class="post-comments p-0 m-0">
                              <li class="mb-2">
                                 <div class="d-flex flex-wrap">
                                    <div class="user-img">
                                       <img src="../assets/images/user/02.jpg" alt="userimg" class="avatar-35 rounded-circle img-fluid">
                                    </div>
                                    <div class="comment-data-block ml-3">
                                       <h6>Monty Carlo</h6>
                                       <p class="mb-0">Lorem ipsum dolor sit amet</p>
                                       <div class="d-flex flex-wrap align-items-center comment-activity">
                                          <a href="#">like</a>
                                          <a href="#">reply</a>
                                          <a href="#">translate</a>
                                          <span> 5 min </span>
                                       </div>
                                    </div>
                                 </div>
                              </li>
                              <li>
                                 <div class="d-flex flex-wrap">
                                    <div class="user-img">
                                       <img src="../assets/images/user/03.jpg" alt="userimg" class="avatar-35 rounded-circle img-fluid">
                                    </div>
                                    <div class="comment-data-block ml-3">
                                       <h6>Paul Molive</h6>
                                       <p class="mb-0">Lorem ipsum dolor sit amet</p>
                                       <div class="d-flex flex-wrap align-items-center comment-activity">
                                          <a href="#">like</a>
                                          <a href="#">reply</a>
                                          <a href="#">translate</a>
                                          <span> 5 min </span>
                                       </div>
                                    </div>
                                 </div>
                              </li>
                           </ul>
                           <form class="comment-text d-flex align-items-center mt-3" action="javascript:void(0);">
                              <input type="text" class="form-control rounded">
                              <div class="comment-attagement d-flex">
                                 <a href="#"><i class="ri-link mr-3"></i></a>
                                 <a href="#"><i class="ri-user-smile-line mr-3"></i></a>
                                 <a href="#"><i class="ri-camera-line mr-3"></i></a>
                              </div>
                           </form>
                        </div>
                     </div>
                  </div>
               </div>
               <!-- post ends here -->

            </div>
            <div class="col-lg-4">
               <div class="card">
                  <div class="card-header d-flex justify-content-between">
                     <div class="header-title">
                        <h4 class="card-title">Stories</h4>
                     </div>
                  </div>
                  <div class="card-body">
                     <ul class="media-story m-0 p-0">
                        <li class="d-flex mb-4 align-items-center">
                           <i class="ri-add-line font-size-18"></i>
                           <div class="stories-data ml-3">
                              <h5>Creat Your Story</h5>
                              <p class="mb-0">time to story</p>
                           </div>
                        </li>
                        <li class="d-flex mb-4 align-items-center active">
                           <img src="../assets/images/page-img/s1.jpg" alt="story-img" class="rounded-circle img-fluid">
                           <div class="stories-data ml-3">
                              <h5>Anna Mull</h5>
                              <p class="mb-0">1 hour ago</p>
                           </div>
                        </li>
                        <li class="d-flex mb-4 align-items-center">
                           <img src="../assets/images/page-img/s2.jpg" alt="story-img" class="rounded-circle img-fluid">
                           <div class="stories-data ml-3">
                              <h5>Ira Membrit</h5>
                              <p class="mb-0">4 hour ago</p>
                           </div>
                        </li>
                        <li class="d-flex align-items-center">
                           <img src="../assets/images/page-img/s3.jpg" alt="story-img" class="rounded-circle img-fluid">
                           <div class="stories-data ml-3">
                              <h5>Bob Frapples</h5>
                              <p class="mb-0">9 hour ago</p>
                           </div>
                        </li>
                     </ul>
                     <a href="#" class="btn btn-primary d-block mt-3">See All</a>
                  </div>
               </div>
               <div class="card">
                  <div class="card-header d-flex justify-content-between">
                     <div class="header-title">
                        <h4 class="card-title">Events</h4>
                     </div>
                     <div class="card-header-toolbar d-flex align-items-center">
                        <div class="dropdown">
                           <span class="dropdown-toggle" id="dropdownMenuButton" data-toggle="dropdown" aria-expanded="false" role="button">
                           <i class="ri-more-fill"></i>
                           </span>
                           <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton" style="">
                              <a class="dropdown-item" href="#"><i class="ri-eye-fill mr-2"></i>View</a>
                              <a class="dropdown-item" href="#"><i class="ri-delete-bin-6-fill mr-2"></i>Delete</a>
                              <a class="dropdown-item" href="#"><i class="ri-pencil-fill mr-2"></i>Edit</a>
                              <a class="dropdown-item" href="#"><i class="ri-printer-fill mr-2"></i>Print</a>
                              <a class="dropdown-item" href="#"><i class="ri-file-download-fill mr-2"></i>Download</a>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="card-body">
                     <ul class="media-story m-0 p-0">
                        <li class="d-flex mb-4 align-items-center active">
                           <img src="../assets/images/page-img/s1.jpg" alt="story-img" class="rounded-circle img-fluid">
                           <div class="stories-data ml-3">
                              <h5>Web Design</h5>
                              <p class="mb-0">1 hour ago</p>
                           </div>
                        </li>
                        <li class="d-flex align-items-center">
                           <img src="../assets/images/page-img/s1.jpg" alt="story-img" class="rounded-circle img-fluid">
                           <div class="stories-data ml-3">
                              <h5>Fun Events and Festivals</h5>
                              <p class="mb-0">1 hour ago</p>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="card">
                  <div class="card-header d-flex justify-content-between">
                     <div class="header-title">
                        <h4 class="card-title">Upcoming Birthday</h4>
                     </div>
                  </div>
                  <div class="card-body">
                     <ul class="media-story m-0 p-0">
                        <li class="d-flex mb-4 align-items-center">
                           <img src="../assets/images/user/01.jpg" alt="story-img" class="rounded-circle img-fluid">
                           <div class="stories-data ml-3">
                              <h5>Anna Sthesia</h5>
                              <p class="mb-0">Today</p>
                           </div>
                        </li>
                        <li class="d-flex align-items-center">
                           <img src="../assets/images/user/02.jpg" alt="story-img" class="rounded-circle img-fluid">
                           <div class="stories-data ml-3">
                              <h5>Paul Molive</h5>
                              <p class="mb-0">Tomorrow</p>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="card">
                  <div class="card-header d-flex justify-content-between">
                     <div class="header-title">
                        <h4 class="card-title">Suggested Pages</h4>
                     </div>
                     <div class="card-header-toolbar d-flex align-items-center">
                        <div class="dropdown">
                           <span class="dropdown-toggle" id="dropdownMenuButton01" data-toggle="dropdown" aria-expanded="false" role="button">
                           <i class="ri-more-fill"></i>
                           </span>
                           <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton01" style="">
                              <a class="dropdown-item" href="#"><i class="ri-eye-fill mr-2"></i>View</a>
                              <a class="dropdown-item" href="#"><i class="ri-delete-bin-6-fill mr-2"></i>Delete</a>
                              <a class="dropdown-item" href="#"><i class="ri-pencil-fill mr-2"></i>Edit</a>
                              <a class="dropdown-item" href="#"><i class="ri-printer-fill mr-2"></i>Print</a>
                              <a class="dropdown-item" href="#"><i class="ri-file-download-fill mr-2"></i>Download</a>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="card-body">
                     <ul class="suggested-page-story m-0 p-0 list-inline">
                        <li class="mb-3">
                           <div class="d-flex align-items-center mb-3">
                              <img src="../assets/images/page-img/42.png" alt="story-img" class="rounded-circle img-fluid avatar-50">
                              <div class="stories-data ml-3">
                                 <h5>xamp Studio</h5>
                                 <p class="mb-0">Lorem Ipsum</p>
                              </div>
                           </div>
                           <img src="../assets/images/small/img-1.jpg" class="img-fluid rounded" alt="Responsive image">
                           <div class="mt-3"><a href="#" class="btn d-block"><i class="ri-thumb-up-line mr-2"></i> Like Page</a></div>
                        </li>
                        <li class="">
                           <div class="d-flex align-items-center mb-3">
                              <img src="../assets/images/page-img/42.png" alt="story-img" class="rounded-circle img-fluid avatar-50">
                              <div class="stories-data ml-3">
                                 <h5>xamp Studio</h5>
                                 <p class="mb-0">Lorem Ipsum</p>
                              </div>
                           </div>
                           <img src="../assets/images/small/img-1.jpg" class="img-fluid rounded" alt="Responsive image">
                           <div class="mt-3"><a href="#" class="btn d-block"><i class="ri-thumb-up-line mr-2"></i> Like Page</a></div>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="col-sm-12 text-center">
               <img src="../assets/images/page-img/page-load-loader.gif" alt="loader" style="height: 100px;">
            </div>
         </div>
      </div>
      </div>
    </div>
    <!-- Wrapper End-->
    <footer class="iq-footer bg-white">
       <div class="container-fluid">
          <div class="row">
             <div class="col-lg-6">
                <ul class="list-inline mb-0">
                   <li class="list-inline-item"><a href="privacy-policy.html">Privacy Policy</a></li>
                   <li class="list-inline-item"><a href="../frontend/html/dashboard/terms-of-service.html">Terms of Use</a></li>
                </ul>
             </div>
             <div class="col-lg-6 d-flex justify-content-end">
                Copyright 2020 <a href="#">SocialV</a> All Rights Reserved.
             </div>
          </div>
       </div>
    </footer>    <!-- Backend Bundle JavaScript -->

    <script th:src="@{/assets/js/libs.min.js}"></script>
    <script th:src="@{/assets/js/slider.js}"></script>
    <script th:src="@{/assets/js/masonry.pkgd.min.js}"></script>
    <script th:src="@{/assets/js/enchanter.js}"></script>
    <script th:src="@{/assets/js/sweetalert.js}"></script>
    <script th:src="@{/assets/js/charts/weather-chart.js}"></script>
    <script th:src="@{/assets/js/app.js}"></script>
    <!-- Datepicker JavaScript -->
    <script th:src="@{/assets/js/lottie.js}"></script>

    <script th:src="@{/assets/js/lottie.js}"></script>


    <!-- Bootstrap and jQuery Scripts -->

    <script>
       // Function to handle form submission
       function createPostCard(postData, image) {
          // Constructing the HTML for the new post card
          const html = `
    <div class="col-sm-12">
        <div class="card card-block card-stretch card-height">
            <div class="card-body">
                <div class="user-post-data">
                    <div class="d-flex flex-wrap">
                        <div class="media-support-user-img mr-3">
                            <img class="rounded-circle img-fluid" src="../assets/images/user/01.jpg" alt="">
                        </div>
                        <div class="media-support-info mt-2">
                            <h5 class="mb-0 d-inline-block"><a href="#" class="">${postData.user.name}</a></h5>
                            <p class="mb-0 d-inline-block">New Post</p>
                            <p class="mb-0 text-primary">Just Now</p>
                        </div>
                    </div>
                </div>
                <div class="mt-3">
                    <p>${postData.content}</p>
                </div>
                <div class="user-post">
                    <div class="d-flex">
                        <div class="col-md-12">
                            <a href="#"><img src="${image.url}" alt="post-image" class="img-fluid rounded w-100"></a>
                        </div>
                    </div>
                </div>
                <div class="comment-area mt-3">
                    <!-- Dummy comments or leave it blank -->
                </div>
            </div>
        </div>
    </div>`;

          // Inserting the new post card at the top of all posts
          const postsContainer = document.querySelector('.new-posts'); // Adjust this selector to match where you want to insert the new post
          postsContainer.insertAdjacentHTML('afterbegin', html);
       }

       document.getElementById('create-post-form').addEventListener('submit', function(event) {
          event.preventDefault();

          const postContent = document.getElementById('postContent').value;
          const fileInput = document.getElementById('imageUpload');
          const file = fileInput.files[0];

          const formData = new FormData();
          formData.append('content', postContent);
          formData.append('file', file);

          const token = localStorage.getItem('token');

          fetch('/api/v1/post/new?userId=123', {
             method: 'POST',
             headers: {
                'Authorization': `Bearer ${token}`,
             },
             body: formData
          })
                  .then(response => {
                     if (!response.ok) {
                        throw new Error('Failed to create post.');
                     }
                     return response.json();
                  })
                  .then(data => {
                     console.log('Post created successfully:', data);
                     // Call function to insert new post card
                     createPostCard(data, { url: URL.createObjectURL(file) }); // Pass the image URL
                     // Clear the form or reset as needed
                     document.getElementById('postContent').value = '';
                     document.getElementById('imageUpload').value = '';
                     document.getElementById('imagePreview').src = '';
                     document.getElementById('imagePreviewContainer').style.display = 'none';
                  })
                  .catch(error => {
                     console.error('Error creating post:', error);
                     // Handle error
                  });
       });

       // Function to preview selected image (already defined in your code)
       function previewImage(input) {
          const preview = document.getElementById('imagePreview');
          const previewContainer = document.getElementById('imagePreviewContainer');
          const file = input.files[0];

          if (file) {
             const reader = new FileReader();

             reader.onload = function(e) {
                preview.src = e.target.result;
                previewContainer.style.display = 'block'; // Show the preview container
             }

             reader.readAsDataURL(file);
          } else {
             preview.src = '';
             previewContainer.style.display = 'none'; // Hide the preview container if no file selected
          }
       }

       // Event listener for file input change (already defined in your code)
       document.getElementById('imageUpload').addEventListener('change', function() {
          previewImage(this);
       });
    </script>



    <!-- offcanvas start -->
 
    <div class="offcanvas offcanvas-bottom share-offcanvas" tabindex="-1" id="share-btn" aria-labelledby="shareBottomLabel">
       <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="shareBottomLabel">Share</h5>
          <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
       </div>
       <div class="offcanvas-body small">
          <div class="d-flex flex-wrap align-items-center">
             <div class="text-center me-3 mb-3">
                <img src="../assets/images/icon/08.png" class="img-fluid rounded mb-2" alt="">
                <h6>Facebook</h6>
             </div>
             <div class="text-center me-3 mb-3">
                <img src="../assets/images/icon/09.png" class="img-fluid rounded mb-2" alt="">
                <h6>Twitter</h6>
             </div>
             <div class="text-center me-3 mb-3">
                <img src="../assets/images/icon/10.png" class="img-fluid rounded mb-2" alt="">
                <h6>Instagram</h6>
             </div>
             <div class="text-center me-3 mb-3">
                <img src="../assets/images/icon/11.png" class="img-fluid rounded mb-2" alt="">
                <h6>Google Plus</h6>
             </div>
             <div class="text-center me-3 mb-3">
                <img src="../assets/images/icon/13.png" class="img-fluid rounded mb-2" alt="">
                <h6>In</h6>
             </div>
             <div class="text-center me-3 mb-3">
                <img src="../assets/images/icon/12.png" class="img-fluid rounded mb-2" alt="">
                <h6>YouTube</h6>
             </div>
          </div>
       </div>
    </div>
  </body>
</html>         